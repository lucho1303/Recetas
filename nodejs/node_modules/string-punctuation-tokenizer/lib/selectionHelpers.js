"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.selectionArray = exports.selectionsToRanges = exports.spliceStringOnRanges = void 0;

var _occurrences = require("./occurrences");

/**
 * Splice string into array of ranges, flagging what is selected
 * @param {String} string - string.
 * @param {Array} ranges - array of ranges [[int,int],...]
 * @return {Array} - array of objects [obj,...]
 */
var spliceStringOnRanges = function spliceStringOnRanges(string, ranges) {
  var selectionArray = []; // response

  var remainingString = string; // shift the range since the loop is destructive by working on the remainingString and not original string

  var rangeShift = 0; // start the range shift at the first character

  ranges.forEach(function (range) {
    var firstCharacterPosition = range[0] - rangeShift; // original range start - the rangeShift

    var beforeSelection = remainingString.slice(0, firstCharacterPosition); // save all the text before the selection

    if (beforeSelection) {
      // only add to the array if string isn't empty
      selectionArray.push({
        text: beforeSelection,
        selected: false
      });
    }

    var shiftedRangeStart = range[0] - rangeShift; // range start - the rangeShift

    var shiftedRangeEnd = range[1] + 1 - rangeShift; // range end - rangeShift + 1 to include last character

    var selection = remainingString.slice(shiftedRangeStart, shiftedRangeEnd); // save the text in the selection

    var stringBeforeRange = string.slice(0, range[0]);
    var occurrence = (0, _occurrences.occurrencesInString)(stringBeforeRange, selection) + 1;
    var occurrences = (0, _occurrences.occurrencesInString)(string, selection);
    var selectionObject = {
      text: selection,
      selected: true,
      occurrence: occurrence,
      occurrences: occurrences
    };
    selectionArray.push(selectionObject); // add the selection to the response array
    // next iteration is using remaining string

    var lastCharacterPosition = range[1] - rangeShift + 1; // original range end position - the rangeShift + 1 to not include the last range character in the remaining string

    remainingString = remainingString.slice(lastCharacterPosition); // update the remainingString to after the range
    // shift the range up to last char of substring (before+sub)

    rangeShift += beforeSelection.length; // adjust the rangeShift by the length prior to the selection

    rangeShift += selection.length; // adjust the rangeShift by the length of the selection itself
  });

  if (remainingString) {
    // only add to the array if string isn't empty
    selectionArray.push({
      text: remainingString,
      selected: false
    });
  }

  return selectionArray;
};
/**
 * Converts ranges to array of selection objects
 * @param {String} string - text used to get the ranges of
 * @param {Array} selections - array of selections [obj,...]
 * @return {Array} - array of range objects
 */


exports.spliceStringOnRanges = spliceStringOnRanges;

var selectionsToRanges = function selectionsToRanges(string, selections) {
  var ranges = []; // response

  selections.forEach(function (selection) {
    if (string && string.includes(selection.text)) {
      // conditions to prevent errors
      var splitArray = string.split(selection.text); // split the string to get the text between occurrences

      var beforeSelection = splitArray.slice(0, selection.occurrence);
      beforeSelection = beforeSelection.join(selection.text); // get the text before the selection to handle multiple occurrences

      var start = beforeSelection.length; // the start position happens at the length of the string that comes before it

      var end = start + selection.text.length - 1; // the end position happens at the end of the selection text, but length doesn't account for 0 based position start

      var range = [start, end]; // new range

      ranges.push(range); // add the new range
    }
  });
  return ranges;
};

exports.selectionsToRanges = selectionsToRanges;

var selectionArray = function selectionArray(string, selections) {
  var selectionArray = [];
  var ranges = selectionsToRanges(string, selections);
  selectionArray = spliceStringOnRanges(string, ranges);
  return selectionArray;
};

exports.selectionArray = selectionArray;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zZWxlY3Rpb25IZWxwZXJzLmpzIl0sIm5hbWVzIjpbInNwbGljZVN0cmluZ09uUmFuZ2VzIiwic3RyaW5nIiwicmFuZ2VzIiwic2VsZWN0aW9uQXJyYXkiLCJyZW1haW5pbmdTdHJpbmciLCJyYW5nZVNoaWZ0IiwiZm9yRWFjaCIsInJhbmdlIiwiZmlyc3RDaGFyYWN0ZXJQb3NpdGlvbiIsImJlZm9yZVNlbGVjdGlvbiIsInNsaWNlIiwicHVzaCIsInRleHQiLCJzZWxlY3RlZCIsInNoaWZ0ZWRSYW5nZVN0YXJ0Iiwic2hpZnRlZFJhbmdlRW5kIiwic2VsZWN0aW9uIiwic3RyaW5nQmVmb3JlUmFuZ2UiLCJvY2N1cnJlbmNlIiwib2NjdXJyZW5jZXMiLCJzZWxlY3Rpb25PYmplY3QiLCJsYXN0Q2hhcmFjdGVyUG9zaXRpb24iLCJsZW5ndGgiLCJzZWxlY3Rpb25zVG9SYW5nZXMiLCJzZWxlY3Rpb25zIiwiaW5jbHVkZXMiLCJzcGxpdEFycmF5Iiwic3BsaXQiLCJqb2luIiwic3RhcnQiLCJlbmQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7Ozs7O0FBTU8sSUFBTUEsb0JBQW9CLEdBQUcsU0FBdkJBLG9CQUF1QixDQUFDQyxNQUFELEVBQVNDLE1BQVQsRUFBb0I7QUFDdEQsTUFBSUMsY0FBYyxHQUFHLEVBQXJCLENBRHNELENBQzdCOztBQUN6QixNQUFJQyxlQUFlLEdBQUdILE1BQXRCLENBRnNELENBR3REOztBQUNBLE1BQUlJLFVBQVUsR0FBRyxDQUFqQixDQUpzRCxDQUlsQzs7QUFDcEJILEVBQUFBLE1BQU0sQ0FBQ0ksT0FBUCxDQUFlLFVBQVNDLEtBQVQsRUFBZ0I7QUFDN0IsUUFBTUMsc0JBQXNCLEdBQUdELEtBQUssQ0FBQyxDQUFELENBQUwsR0FBU0YsVUFBeEMsQ0FENkIsQ0FDdUI7O0FBQ3BELFFBQU1JLGVBQWUsR0FBR0wsZUFBZSxDQUFDTSxLQUFoQixDQUFzQixDQUF0QixFQUF5QkYsc0JBQXpCLENBQXhCLENB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R0FBRyxHQUFHRCxLQUFLLEdBQUdiLFNBQVMsQ0FBQ0osSUFBVixDQUFlVSxNQUF2QixHQUFnQyxDQUE1QyxDQUw2QyxDQUtFOztBQUMvQyxVQUFNZixLQUFLLEdBQUcsQ0FBQ3NCLEtBQUQsRUFBUUMsR0FBUixDQUFkLENBTjZDLENBTWpCOztBQUM1QjVCLE1BQUFBLE1BQU0sQ0FBQ1MsSUFBUCxDQUFZSixLQUFaLEVBUDZDLENBT3pCO0FBQ3JCO0FBQ0YsR0FWRDtBQVdGLFNBQU9MLE1BQVA7QUFDRCxDQWRNOzs7O0FBZ0JBLElBQU1DLGNBQWMsR0FBRyx3QkFBQ0YsTUFBRCxFQUFTdUIsVUFBVCxFQUF3QjtBQUNwRCxNQUFJckIsY0FBYyxHQUFHLEVBQXJCO0FBQ0EsTUFBSUQsTUFBTSxHQUFHcUIsa0JBQWtCLENBQUN0QixNQUFELEVBQVN1QixVQUFULENBQS9CO0FBQ0FyQixFQUFBQSxjQUFjLEdBQUdILG9CQUFvQixDQUFDQyxNQUFELEVBQVNDLE1BQVQsQ0FBckM7QUFDQSxTQUFPQyxjQUFQO0FBQ0QsQ0FMTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7b2NjdXJyZW5jZXNJblN0cmluZ30gZnJvbSAnLi9vY2N1cnJlbmNlcyc7XHJcbi8qKlxyXG4gKiBTcGxpY2Ugc3RyaW5nIGludG8gYXJyYXkgb2YgcmFuZ2VzLCBmbGFnZ2luZyB3aGF0IGlzIHNlbGVjdGVkXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgLSBzdHJpbmcuXHJcbiAqIEBwYXJhbSB7QXJyYXl9IHJhbmdlcyAtIGFycmF5IG9mIHJhbmdlcyBbW2ludCxpbnRdLC4uLl1cclxuICogQHJldHVybiB7QXJyYXl9IC0gYXJyYXkgb2Ygb2JqZWN0cyBbb2JqLC4uLl1cclxuICovXHJcbmV4cG9ydCBjb25zdCBzcGxpY2VTdHJpbmdPblJhbmdlcyA9IChzdHJpbmcsIHJhbmdlcykgPT4ge1xyXG4gIGxldCBzZWxlY3Rpb25BcnJheSA9IFtdOyAvLyByZXNwb25zZVxyXG4gIGxldCByZW1haW5pbmdTdHJpbmcgPSBzdHJpbmc7XHJcbiAgLy8gc2hpZnQgdGhlIHJhbmdlIHNpbmNlIHRoZSBsb29wIGlzIGRlc3RydWN0aXZlIGJ5IHdvcmtpbmcgb24gdGhlIHJlbWFpbmluZ1N0cmluZyBhbmQgbm90IG9yaWdpbmFsIHN0cmluZ1xyXG4gIGxldCByYW5nZVNoaWZ0ID0gMDsgLy8gc3RhcnQgdGhlIHJhbmdlIHNoaWZ0IGF0IHRoZSBmaXJzdCBjaGFyYWN0ZXJcclxuICByYW5nZXMuZm9yRWFjaChmdW5jdGlvbihyYW5nZSkge1xyXG4gICAgY29uc3QgZmlyc3RDaGFyYWN0ZXJQb3NpdGlvbiA9IHJhbmdlWzBdLXJhbmdlU2hpZnQ7IC8vIG9yaWdpbmFsIHJhbmdlIHN0YXJ0IC0gdGhlIHJhbmdlU2hpZnRcclxuICAgIGNvbnN0IGJlZm9yZVNlbGVjdGlvbiA9IHJlbWFpbmluZ1N0cmluZy5zbGljZSgwLCBmaXJzdENoYXJhY3RlclBvc2l0aW9uKTsgLy8gc2F2ZSBhbGwgdGhlIHRleHQgYmVmb3JlIHRoZSBzZWxlY3Rpb25cclxuICAgIGlmIChiZWZvcmVTZWxlY3Rpb24pIHsgLy8gb25seSBhZGQgdG8gdGhlIGFycmF5IGlmIHN0cmluZyBpc24ndCBlbXB0eVxyXG4gICAgICBzZWxlY3Rpb25BcnJheS5wdXNoKHt0ZXh0OiBiZWZvcmVTZWxlY3Rpb24sIHNlbGVjdGVkOiBmYWxzZX0pO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc2hpZnRlZFJhbmdlU3RhcnQgPSByYW5nZVswXS1yYW5nZVNoaWZ0OyAvLyByYW5nZSBzdGFydCAtIHRoZSByYW5nZVNoaWZ0XHJcbiAgICBjb25zdCBzaGlmdGVkUmFuZ2VFbmQgPSByYW5nZVsxXSsxLXJhbmdlU2hpZnQ7IC8vIHJhbmdlIGVuZCAtIHJhbmdlU2hpZnQgKyAxIHRvIGluY2x1ZGUgbGFzdCBjaGFyYWN0ZXJcclxuICAgIGNvbnN0IHNlbGVjdGlvbiA9IHJlbWFpbmluZ1N0cmluZy5zbGljZShzaGlmdGVkUmFuZ2VTdGFydCwgc2hpZnRlZFJhbmdlRW5kKTsgLy8gc2F2ZSB0aGUgdGV4dCBpbiB0aGUgc2VsZWN0aW9uXHJcbiAgICBjb25zdCBzdHJpbmdCZWZvcmVSYW5nZSA9IHN0cmluZy5zbGljZSgwLCByYW5nZVswXSk7XHJcbiAgICBjb25zdCBvY2N1cnJlbmNlID0gb2NjdXJyZW5jZXNJblN0cmluZyhzdHJpbmdCZWZvcmVSYW5nZSwgc2VsZWN0aW9uKSArIDE7XHJcbiAgICBjb25zdCBvY2N1cnJlbmNlcyA9IG9jY3VycmVuY2VzSW5TdHJpbmcoc3RyaW5nLCBzZWxlY3Rpb24pO1xyXG4gICAgY29uc3Qgc2VsZWN0aW9uT2JqZWN0ID0ge1xyXG4gICAgICB0ZXh0OiBzZWxlY3Rpb24sXHJcbiAgICAgIHNlbGVjdGVkOiB0cnVlLFxyXG4gICAgICBvY2N1cnJlbmNlOiBvY2N1cnJlbmNlLFxyXG4gICAgICBvY2N1cnJlbmNlczogb2NjdXJyZW5jZXMsXHJcbiAgICB9O1xyXG4gICAgc2VsZWN0aW9uQXJyYXkucHVzaChzZWxlY3Rpb25PYmplY3QpOyAvLyBhZGQgdGhlIHNlbGVjdGlvbiB0byB0aGUgcmVzcG9uc2UgYXJyYXlcclxuICAgIC8vIG5leHQgaXRlcmF0aW9uIGlzIHVzaW5nIHJlbWFpbmluZyBzdHJpbmdcclxuICAgIGNvbnN0IGxhc3RDaGFyYWN0ZXJQb3NpdGlvbiA9IHJhbmdlWzFdLXJhbmdlU2hpZnQrMTsgLy8gb3JpZ2luYWwgcmFuZ2UgZW5kIHBvc2l0aW9uIC0gdGhlIHJhbmdlU2hpZnQgKyAxIHRvIG5vdCBpbmNsdWRlIHRoZSBsYXN0IHJhbmdlIGNoYXJhY3RlciBpbiB0aGUgcmVtYWluaW5nIHN0cmluZ1xyXG4gICAgcmVtYWluaW5nU3RyaW5nID0gcmVtYWluaW5nU3RyaW5nLnNsaWNlKGxhc3RDaGFyYWN0ZXJQb3NpdGlvbik7IC8vIHVwZGF0ZSB0aGUgcmVtYWluaW5nU3RyaW5nIHRvIGFmdGVyIHRoZSByYW5nZVxyXG4gICAgLy8gc2hpZnQgdGhlIHJhbmdlIHVwIHRvIGxhc3QgY2hhciBvZiBzdWJzdHJpbmcgKGJlZm9yZStzdWIpXHJcbiAgICByYW5nZVNoaWZ0ICs9IGJlZm9yZVNlbGVjdGlvbi5sZW5ndGg7IC8vIGFkanVzdCB0aGUgcmFuZ2VTaGlmdCBieSB0aGUgbGVuZ3RoIHByaW9yIHRvIHRoZSBzZWxlY3Rpb25cclxuICAgIHJhbmdlU2hpZnQgKz0gc2VsZWN0aW9uLmxlbmd0aDsgLy8gYWRqdXN0IHRoZSByYW5nZVNoaWZ0IGJ5IHRoZSBsZW5ndGggb2YgdGhlIHNlbGVjdGlvbiBpdHNlbGZcclxuICB9KTtcclxuICBpZiAocmVtYWluaW5nU3RyaW5nKSB7IC8vIG9ubHkgYWRkIHRvIHRoZSBhcnJheSBpZiBzdHJpbmcgaXNuJ3QgZW1wdHlcclxuICAgIHNlbGVjdGlvbkFycmF5LnB1c2goe3RleHQ6IHJlbWFpbmluZ1N0cmluZywgc2VsZWN0ZWQ6IGZhbHNlfSk7XHJcbiAgfVxyXG4gIHJldHVybiBzZWxlY3Rpb25BcnJheTtcclxufTtcclxuLyoqXHJcbiAqIENvbnZlcnRzIHJhbmdlcyB0byBhcnJheSBvZiBzZWxlY3Rpb24gb2JqZWN0c1xyXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nIC0gdGV4dCB1c2VkIHRvIGdldCB0aGUgcmFuZ2VzIG9mXHJcbiAqIEBwYXJhbSB7QXJyYXl9IHNlbGVjdGlvbnMgLSBhcnJheSBvZiBzZWxlY3Rpb25zIFtvYmosLi4uXVxyXG4gKiBAcmV0dXJuIHtBcnJheX0gLSBhcnJheSBvZiByYW5nZSBvYmplY3RzXHJcbiAqL1xyXG5leHBvcnQgY29uc3Qgc2VsZWN0aW9uc1RvUmFuZ2VzID0gKHN0cmluZywgc2VsZWN0aW9ucykgPT4ge1xyXG4gIGxldCByYW5nZXMgPSBbXTsgLy8gcmVzcG9uc2VcclxuICAgIHNlbGVjdGlvbnMuZm9yRWFjaCggKHNlbGVjdGlvbikgPT4ge1xyXG4gICAgICBpZiAoc3RyaW5nICYmIHN0cmluZy5pbmNsdWRlcyhzZWxlY3Rpb24udGV4dCkpIHsgLy8gY29uZGl0aW9ucyB0byBwcmV2ZW50IGVycm9yc1xyXG4gICAgICAgIGNvbnN0IHNwbGl0QXJyYXkgPSBzdHJpbmcuc3BsaXQoc2VsZWN0aW9uLnRleHQpOyAvLyBzcGxpdCB0aGUgc3RyaW5nIHRvIGdldCB0aGUgdGV4dCBiZXR3ZWVuIG9jY3VycmVuY2VzXHJcbiAgICAgICAgbGV0IGJlZm9yZVNlbGVjdGlvbiA9IHNwbGl0QXJyYXkuc2xpY2UoMCwgc2VsZWN0aW9uLm9jY3VycmVuY2UpO1xyXG4gICAgICAgIGJlZm9yZVNlbGVjdGlvbiA9IGJlZm9yZVNlbGVjdGlvbi5qb2luKHNlbGVjdGlvbi50ZXh0KTsgLy8gZ2V0IHRoZSB0ZXh0IGJlZm9yZSB0aGUgc2VsZWN0aW9uIHRvIGhhbmRsZSBtdWx0aXBsZSBvY2N1cnJlbmNlc1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gYmVmb3JlU2VsZWN0aW9uLmxlbmd0aDsgLy8gdGhlIHN0YXJ0IHBvc2l0aW9uIGhhcHBlbnMgYXQgdGhlIGxlbmd0aCBvZiB0aGUgc3RyaW5nIHRoYXQgY29tZXMgYmVmb3JlIGl0XHJcbiAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBzZWxlY3Rpb24udGV4dC5sZW5ndGggLSAxOyAvLyB0aGUgZW5kIHBvc2l0aW9uIGhhcHBlbnMgYXQgdGhlIGVuZCBvZiB0aGUgc2VsZWN0aW9uIHRleHQsIGJ1dCBsZW5ndGggZG9lc24ndCBhY2NvdW50IGZvciAwIGJhc2VkIHBvc2l0aW9uIHN0YXJ0XHJcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBbc3RhcnQsIGVuZF07IC8vIG5ldyByYW5nZVxyXG4gICAgICAgIHJhbmdlcy5wdXNoKHJhbmdlKTsgLy8gYWRkIHRoZSBuZXcgcmFuZ2VcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgcmV0dXJuIHJhbmdlcztcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3Rpb25BcnJheSA9IChzdHJpbmcsIHNlbGVjdGlvbnMpID0+IHtcclxuICBsZXQgc2VsZWN0aW9uQXJyYXkgPSBbXTtcclxuICBsZXQgcmFuZ2VzID0gc2VsZWN0aW9uc1RvUmFuZ2VzKHN0cmluZywgc2VsZWN0aW9ucyk7XHJcbiAgc2VsZWN0aW9uQXJyYXkgPSBzcGxpY2VTdHJpbmdPblJhbmdlcyhzdHJpbmcsIHJhbmdlcyk7XHJcbiAgcmV0dXJuIHNlbGVjdGlvbkFycmF5O1xyXG59O1xyXG4iXX0=